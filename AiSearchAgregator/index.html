<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Search Aggregator - CraftKontrol</title>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-title">
            <h1 data-lang="title">AI Search Aggregator</h1>
            <p data-lang="subtitle">Recherche intelligente multi-sources avec IA</p>
        </div>
        <div class="header-controls">
            <button class="btn-export" onclick="exportResults()" id="exportBtn">
                <span class="material-symbols-outlined">download</span>
                <span data-lang="export">Exporter JSON</span>
            </button>
            <div class="language-selector">
                <label for="languageSelect">
                    <span class="material-symbols-outlined">language</span>
                </label>
                <select id="languageSelect" onchange="changeLanguage()">
                    <option value="fr" selected>Français</option>
                    <option value="en">English</option>
                    <option value="it">Italiano</option>
                </select>
            </div>
        </div>
        <div class="credits">
            <span>CraftKontrol © 2025</span>
            <div class="last-modified">
                <span id="lastModified">Chargement...</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div id="errorMessage" class="error-message" style="display: none;"></div>

        <!-- Search Section -->
        <section class="search-section">
            <h2>
                <span class="material-symbols-outlined">manage_search</span>
                <span data-lang="searchTitle">Recherche intelligente</span>
            </h2>
            
            <div class="search-container">
                <div class="search-input-group">
                    <input type="text" 
                           id="searchInput" 
                           placeholder="Entrez votre recherche..." 
                           data-lang-placeholder="searchPlaceholder"
                           onkeypress="handleSearchKeypress(event)" />
                    <button class="btn-voice" id="voiceBtn" onclick="startVoiceSearch()" title="Recherche vocale">
                        <span class="material-symbols-outlined">mic</span>
                    </button>
                    <button class="btn-search" onclick="performSearch()">
                        <span class="material-symbols-outlined">search</span>
                        <span data-lang="search">Rechercher</span>
                    </button>
                </div>
                
                <!-- Spectrum VU Meter -->
                <div class="spectrum-container" id="spectrumContainer" style="display: none;">
                    <canvas id="spectrumCanvas" class="spectrum-canvas"></canvas>
                </div>
                
                <div class="search-status" id="searchStatus" style="display: none;">
                    <div class="status-item">
                        <span class="material-symbols-outlined">language</span>
                        <span data-lang="detectedLang">Langue détectée:</span>
                        <strong id="detectedLanguage">-</strong>
                    </div>
                    <div class="status-item">
                        <span class="material-symbols-outlined">query_stats</span>
                        <span data-lang="queryOptimized">Requête optimisée:</span>
                        <strong id="optimizedQuery">-</strong>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Summary Section -->
        <section class="summary-section" id="summarySection" style="display: none;">
            <h2>
                <span class="material-symbols-outlined">auto_awesome</span>
                <span data-lang="aiSummary">Résumé IA de la recherche</span>
            </h2>
            <div class="audio-controls" id="audioControls" style="display: none;">
                <button class="btn-audio" id="playPauseBtn" onclick="togglePlayPause()" title="Lecture/Pause">
                    <span class="material-symbols-outlined">play_arrow</span>
                </button>
                <button class="btn-audio" id="stopBtn" onclick="stopAudio()" title="Arrêter">
                    <span class="material-symbols-outlined">stop</span>
                </button>
                <div class="audio-progress" id="audioProgressContainer" style="display: none;">
                    <div class="progress-bar" id="audioProgressBar"></div>
                </div>
                <span class="audio-status" id="audioStatus"></span>
            </div>
            <div class="summary-content" id="summaryContent">
                <div class="summary-loading">
                    <div class="spinner-small"></div>
                    <p data-lang="generatingSummary">Génération du résumé...</p>
                </div>
            </div>
        </section>

        <!-- Statistics Section -->
        <section class="stats-section" id="statsSection" style="display: none;">
            <h2>
                <span class="material-symbols-outlined">analytics</span>
                <span data-lang="statistics">Statistiques</span>
            </h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <span class="material-symbols-outlined">article</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" id="statTotal">0</span>
                        <span class="stat-label" data-lang="totalResults">Résultats totaux</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <span class="material-symbols-outlined">hub</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" id="statSources">0</span>
                        <span class="stat-label" data-lang="sourcesUsed">Sources utilisées</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <span class="material-symbols-outlined">content_copy</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" id="statDuplicates">0</span>
                        <span class="stat-label" data-lang="duplicatesRemoved">Doublons retirés</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <span class="material-symbols-outlined">timer</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" id="statTime">0s</span>
                        <span class="stat-label" data-lang="searchTime">Temps de recherche</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Filter Section -->
        <section class="filter-section" id="filterSection" style="display: none;">
            <h2>
                <span class="material-symbols-outlined">filter_list</span>
                <span data-lang="filters">Filtres</span>
            </h2>
            
            <div class="filters-container">

                <div class="filter-group">
                    <label for="filterDate">
                        <span class="material-symbols-outlined">calendar_today</span>
                        <span data-lang="filterByDate">Filtrer par date</span>
                    </label>
                    <select id="filterDate" onchange="applyFilters()">
                        <option value="all" data-lang="allDates">Toutes les dates</option>
                        <option value="today" data-lang="today">Aujourd'hui</option>
                        <option value="week" data-lang="thisWeek">Cette semaine</option>
                        <option value="month" data-lang="thisMonth">Ce mois-ci</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filterSource">
                        <span class="material-symbols-outlined">source</span>
                        <span data-lang="filterBySource">Filtrer par source</span>
                    </label>
                    <select id="filterSource" onchange="applyFilters()">
                        <option value="all" data-lang="allSources">Toutes les sources</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filterDomain">
                        <span class="material-symbols-outlined">public</span>
                        <span data-lang="filterByDomain">Filtrer par domaine</span>
                    </label>
                    <select id="filterDomain" onchange="applyFilters()">
                        <option value="all" data-lang="allDomains">Tous les domaines</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="filterLanguage">
                        <span class="material-symbols-outlined">translate</span>
                        <span data-lang="filterByLanguage">Filtrer par langue</span>
                    </label>
                    <select id="filterLanguage" onchange="applyFilters()">
                        <option value="all" data-lang="allLanguages">Toutes les langues</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="sortBy">
                        <span class="material-symbols-outlined">sort</span>
                        <span data-lang="sortBy">Trier par</span>
                    </label>
                    <select id="sortBy" onchange="applyFilters()">
                        <option value="score" data-lang="sortScore">Score (pertinence)</option>
                        <option value="date" data-lang="sortDate">Date (récent d'abord)</option>
                        <option value="source" data-lang="sortSource">Source</option>
                        <option value="domain" data-lang="sortDomain">Domaine</option>
                    </select>
                </div>
                
                <button class="btn-reset-filters" onclick="resetFilters()">
                    <span class="material-symbols-outlined">filter_alt_off</span>
                    <span data-lang="resetFilters">Réinitialiser les filtres</span>
                </button>
            </div>
        </section>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="loading-indicator" style="display: none;">
            <div class="spinner"></div>
            <p data-lang="loading">Recherche en cours...</p>
            <div class="progress-container" id="progressContainer">
                <!-- Progress items will be populated dynamically -->
            </div>
        </div>

        <!-- Results Container -->
        <div class="results-container" id="resultsContainer" style="display: none;">
            <!-- Results will be populated by JavaScript -->
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state">
            <span class="material-symbols-outlined">search</span>
            <p data-lang="emptyTitle">Commencez une recherche</p>
            <p data-lang="emptyDesc">Entrez votre requête ou utilisez la recherche vocale pour découvrir des contenus pertinents de plusieurs sources</p>
        </div>
        
        <span class="section-divider" style="height: 20px; display: block;"></span>

        <!-- API Keys Management Section -->
        <section class="api-management-section">
            <h2>
                <span class="material-symbols-outlined">key</span>
                <span data-lang="apiKeysManagement">Gestion des clés API</span>
                <button class="section-toggle" onclick="toggleSection('apiKeysContent')" id="apiToggleBtn">
                    <span data-lang="hide">Masquer</span>
                </button>
            </h2>
            
            <div id="apiKeysContent" class="section-content">
                <!-- STT/TTS Provider Selection -->
                <div class="provider-selection">
                    <div class="provider-card">
                        <h3>
                            <span class="material-symbols-outlined">mic</span>
                            <span data-lang="sttProvider">Fournisseur STT</span>
                        </h3>
                        <select id="sttProvider" onchange="saveProviderSettings()">
                            <option value="browser" selected data-lang-option="browserSTT">Navigateur (Gratuit)</option>
                            <option value="deepgram" data-lang-option="deepgramSTT">Deepgram API</option>
                            <option value="google" data-lang-option="googleSTT">Google Cloud STT</option>
                        </select>
                        <p class="provider-hint" data-lang="sttHint">Reconnaissance vocale pour la recherche</p>
                    </div>
                    
                    <div class="provider-card">
                        <h3>
                            <span class="material-symbols-outlined">record_voice_over</span>
                            <span data-lang="ttsProvider">Fournisseur TTS</span>
                        </h3>
                        <select id="ttsProvider" onchange="updateTTSProviderVoices(); saveProviderSettings();">
                            <option value="browser" selected data-lang-option="browserTTS">Navigateur (Gratuit)</option>
                            <option value="deepgram" data-lang-option="deepgramTTS">Deepgram API</option>
                            <option value="google" data-lang-option="googleTTS">Google Cloud TTS</option>
                        </select>
                        <p class="provider-hint" data-lang="ttsHint">Synthèse vocale pour les résumés</p>
                    </div>
                </div>

                <!-- AI & Core Services -->
                <h3 class="api-section-title">
                    <span class="material-symbols-outlined">psychology</span>
                    <span data-lang="aiServices">Services IA</span>
                </h3>
                <div class="api-keys-grid">
                    <!-- Mistral AI (Required) -->
                    <div class="api-key-card required">
                        <h3>
                            <span class="material-symbols-outlined">smart_toy</span>
                            Mistral AI
                            <span class="required-badge">Requis</span>
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyMistral" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('mistral')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://console.mistral.ai/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API gratuite →</a>
                        <p class="api-description" data-lang="mistralDesc">Détection de langue et extraction de contenu IA</p>
                    </div>
                </div>

                <!-- Speech Services (STT/TTS) -->
                <h3 class="api-section-title">
                    <span class="material-symbols-outlined">voice_chat</span>
                    <span data-lang="speechServices">Services Vocaux (STT/TTS)</span>
                </h3>
                <div class="api-keys-grid">
                    <!-- Deepgram STT (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">mic</span>
                            Deepgram STT
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyDeepgram" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('deepgram')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://console.deepgram.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                        <p class="api-description" data-lang="deepgramDesc">Reconnaissance vocale (FR/IT/EN)</p>
                    </div>

                    <!-- Deepgram TTS (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">record_voice_over</span>
                            Deepgram TTS
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyDeepgramTTS" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('deepgramtts')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://console.deepgram.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                        <p class="api-description" data-lang="deepgramTTSDesc">Synthèse vocale (FR/IT/EN)</p>
                    </div>

                    <!-- Google Cloud STT (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">mic</span>
                            Google Cloud STT
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyGoogleSTT" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('googlestt')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://console.cloud.google.com/apis/library/speech.googleapis.com" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                        <p class="api-description" data-lang="googleSTTDesc">Reconnaissance vocale Google (FR/IT/EN)</p>
                    </div>

                    <!-- Google Cloud TTS (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">speaker</span>
                            Google Cloud TTS
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyGoogleTTS" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('googletts')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                        <p class="api-description" data-lang="googleTTSDesc">Synthèse vocale du résumé IA</p>
                    </div>
                </div>

                <!-- Search Services -->
                <h3 class="api-section-title">
                    <span class="material-symbols-outlined">travel_explore</span>
                    <span data-lang="searchServices">Services de Recherche</span>
                </h3>
                <div class="api-keys-grid">
                    <!-- Tavily (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">search</span>
                            Tavily Search
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyTavily" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('tavily')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://tavily.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                    </div>

                    <!-- ScrapingBee (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">precision_manufacturing</span>
                            ScrapingBee
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyScrapingBee" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('scrapingbee')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://www.scrapingbee.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                    </div>

                    <!-- ScraperAPI (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">data_array</span>
                            ScraperAPI
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyScraperAPI" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('scraperapi')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://www.scraperapi.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                    </div>

                    <!-- Bright Data (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">cloud</span>
                            Bright Data
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyBrightData" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('brightdata')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://brightdata.com/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                    </div>

                    <!-- ScrapFly (Optional) -->
                    <div class="api-key-card">
                        <h3>
                            <span class="material-symbols-outlined">flight_takeoff</span>
                            ScrapFly
                        </h3>
                        <div class="api-input-wrapper">
                            <input type="password" id="apiKeyScrapFly" placeholder="Entrez la clé API..." data-lang-placeholder="enterApiKey" />
                            <button class="btn-delete" onclick="deleteApiKey('scrapfly')" title="Supprimer la clé">×</button>
                        </div>
                        <a href="https://scrapfly.io/" target="_blank" class="api-link" data-lang="getApiKey">Obtenir une clé API →</a>
                    </div>
                </div>

                <div class="api-actions">
                    <label class="remember-key-label">
                        <input type="checkbox" id="rememberKeys" checked />
                        <span data-lang="rememberKeys">Mémoriser les clés API</span>
                    </label>
                    <button class="btn-save" onclick="saveApiKeys()">
                        <span class="material-symbols-outlined">save</span>
                        <span data-lang="saveKeys">Enregistrer les clés</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Mistral Conversation Settings -->
        <section class="mistral-settings-section">
            <h2>
                <span class="material-symbols-outlined">psychology</span>
                <span data-lang="mistralSettings">Paramètres de conversation Mistral</span>
                <button class="section-toggle" onclick="toggleSection('mistralSettingsContent')" id="mistralToggleBtn">
                    <span data-lang="show">Afficher</span>
                </button>
            </h2>
            
            <div id="mistralSettingsContent" class="section-content" style="display: none;">
                <div class="mistral-settings-grid">
                    <div class="setting-card full-width">
                        <label for="systemPrompt">
                            <span class="material-symbols-outlined">description</span>
                            <span data-lang="systemPrompt">Prompt système</span>
                        </label>
                        <textarea id="systemPrompt" rows="6" placeholder="Entrez le prompt système pour guider le comportement de l'IA..." data-lang-placeholder="systemPromptPlaceholder">Vous êtes un assistant de recherche IA expert. Votre rôle est d'analyser les résultats de recherche provenant de multiples sources et de créer un résumé concis, informatif et bien structuré. Présentez les informations de manière claire et objective, en citant les sources pertinentes. Mettez en évidence les points clés et les tendances importantes.</textarea>
                        <p class="setting-hint" data-lang="systemPromptHint">Définit le comportement et le style de réponse de l'IA</p>
                    </div>

                    <div class="setting-card">
                        <label for="mistralModel">
                            <span class="material-symbols-outlined">model_training</span>
                            <span data-lang="model">Modèle</span>
                        </label>
                        <select id="mistralModel">
                            <option value="mistral-small-latest">Mistral Small (Rapide)</option>
                            <option value="mistral-medium-latest" selected>Mistral Medium (Équilibré)</option>
                            <option value="mistral-large-latest">Mistral Large (Puissant)</option>
                            <option value="open-mistral-7b">Open Mistral 7B</option>
                            <option value="open-mixtral-8x7b">Open Mixtral 8x7B</option>
                            <option value="open-mixtral-8x22b">Open Mixtral 8x22B</option>
                        </select>
                        <p class="setting-hint" data-lang="modelHint">Choisissez le modèle selon vos besoins de performance/qualité</p>
                    </div>

                    <div class="setting-card">
                        <label for="mistralTemperature">
                            <span class="material-symbols-outlined">thermostat</span>
                            <span data-lang="temperature">Température</span>
                            <span class="setting-value" id="temperatureValue">0.7</span>
                        </label>
                        <input type="range" id="mistralTemperature" min="0" max="1" step="0.1" value="0.7" oninput="updateMistralValue('temperature', this.value)" />
                        <div class="range-labels">
                            <span>0 (Précis)</span>
                            <span>0.5</span>
                            <span>1 (Créatif)</span>
                        </div>
                        <p class="setting-hint" data-lang="temperatureHint">Contrôle la créativité des réponses (0 = déterministe, 1 = créatif)</p>
                    </div>

                    <div class="setting-card">
                        <label for="mistralMaxTokens">
                            <span class="material-symbols-outlined">text_fields</span>
                            <span data-lang="maxTokens">Tokens maximum</span>
                            <span class="setting-value" id="maxTokensValue">2000</span>
                        </label>
                        <input type="range" id="mistralMaxTokens" min="100" max="4000" step="100" value="2000" oninput="updateMistralValue('maxTokens', this.value)" />
                        <div class="range-labels">
                            <span>100</span>
                            <span>2000</span>
                            <span>4000</span>
                        </div>
                        <p class="setting-hint" data-lang="maxTokensHint">Longueur maximale de la réponse générée</p>
                    </div>

                    <div class="setting-card">
                        <label for="mistralTopP">
                            <span class="material-symbols-outlined">filter_alt</span>
                            <span data-lang="topP">Top P (nucleus sampling)</span>
                            <span class="setting-value" id="topPValue">0.9</span>
                        </label>
                        <input type="range" id="mistralTopP" min="0" max="1" step="0.05" value="0.9" oninput="updateMistralValue('topP', this.value)" />
                        <div class="range-labels">
                            <span>0</span>
                            <span>0.5</span>
                            <span>1</span>
                        </div>
                        <p class="setting-hint" data-lang="topPHint">Contrôle la diversité en filtrant les tokens peu probables</p>
                    </div>

                    <div class="setting-card">
                        <label>
                            <span class="material-symbols-outlined">settings_suggest</span>
                            <span data-lang="advancedOptions">Options avancées</span>
                        </label>
                        <label class="setting-checkbox-label">
                            <input type="checkbox" id="mistralSafeMode" />
                            <span data-lang="safeMode">Mode sécurisé (Safe Mode)</span>
                        </label>
                        <label class="setting-checkbox-label">
                            <input type="checkbox" id="mistralRandomSeed" />
                            <span data-lang="useRandomSeed">Utiliser une graine aléatoire (reproductibilité)</span>
                        </label>
                        <p class="setting-hint" data-lang="advancedHint">Options de sécurité et de reproductibilité</p>
                    </div>
                </div>

                <div class="mistral-actions">
                    <button class="btn-reset" onclick="resetMistralSettings()">
                        <span class="material-symbols-outlined">restart_alt</span>
                        <span data-lang="resetToDefault">Réinitialiser par défaut</span>
                    </button>
                    <button class="btn-save" onclick="saveMistralSettings()">
                        <span class="material-symbols-outlined">save</span>
                        <span data-lang="saveSettings">Enregistrer les paramètres</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Rate Limiting Configuration -->
        <section class="rate-limit-section">
            <h2>
                <span class="material-symbols-outlined">speed</span>
                <span data-lang="rateLimiting">Configuration des limites de taux</span>
                <button class="section-toggle" onclick="toggleSection('rateLimitContent')" id="rateLimitToggleBtn">
                    <span data-lang="show">Afficher</span>
                </button>
            </h2>
            
            <div id="rateLimitContent" class="section-content" style="display: none;">
                <div class="rate-limit-grid">
                    <div class="rate-limit-card">
                        <label for="requestsPerMinute">
                            <span data-lang="requestsPerMin">Requêtes par minute</span>
                        </label>
                        <input type="number" id="requestsPerMinute" value="10" min="1" max="60" />
                        <p class="rate-hint" data-lang="requestsPerMinHint">Nombre max de requêtes par minute (toutes sources)</p>
                    </div>
                    
                    <div class="rate-limit-card">
                        <label for="delayBetweenRequests">
                            <span data-lang="delayBetween">Délai entre requêtes (ms)</span>
                        </label>
                        <input type="number" id="delayBetweenRequests" value="1000" min="100" max="5000" step="100" />
                        <p class="rate-hint" data-lang="delayBetweenHint">Pause minimale entre chaque requête</p>
                    </div>
                    
                    <div class="rate-limit-card">
                        <label for="maxConcurrent">
                            <span data-lang="maxConcurrent">Requêtes simultanées</span>
                        </label>
                        <input type="number" id="maxConcurrent" value="3" min="1" max="10" />
                        <p class="rate-hint" data-lang="maxConcurrentHint">Nombre de sources interrogées en parallèle</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Text-to-Speech Configuration -->
        <section class="tts-section">
            <h2>
                <span class="material-symbols-outlined">speaker</span>
                <span data-lang="ttsSettings">Paramètres de synthèse vocale</span>
                <button class="section-toggle" onclick="toggleSection('ttsContent')" id="ttsToggleBtn">
                    <span data-lang="show">Afficher</span>
                </button>
            </h2>
            
            <div id="ttsContent" class="section-content" style="display: none;">
                <div class="tts-grid">
                    <div class="tts-card">
                        <label for="ttsVoice">
                            <span class="material-symbols-outlined">voice_selection</span>
                            <span data-lang="selectVoice">Sélectionner une voix</span>
                        </label>
                        <select id="ttsVoice" onchange="updateTTSVoice(this.value)">
                            <optgroup label="Navigateur - Browser" data-provider="browser">
                                <option value="browser-default" data-provider="browser" selected>Voix par défaut / Default Voice</option>
                            </optgroup>
                            <optgroup label="Deepgram - Français" data-provider="deepgram">
                                <option value="aura-2-agathe-fr" data-provider="deepgram">Agathe (Femme)</option>
                                <option value="aura-2-hector-fr" data-provider="deepgram">Hector (Homme)</option>
                            </optgroup>
                            <optgroup label="Deepgram - English" data-provider="deepgram">
                                <option value="aura-2-thalia-en" data-provider="deepgram">Thalia (Female)</option>
                                <option value="aura-2-andromeda-en" data-provider="deepgram">Andromeda (Female)</option>
                                <option value="aura-2-helena-en" data-provider="deepgram">Helena (Female)</option>
                                <option value="aura-2-athena-en" data-provider="deepgram">Athena (Female)</option>
                                <option value="aura-2-hera-en" data-provider="deepgram">Hera (Female)</option>
                                <option value="aura-2-luna-en" data-provider="deepgram">Luna (Female)</option>
                                <option value="aura-2-apollo-en" data-provider="deepgram">Apollo (Male)</option>
                                <option value="aura-2-arcas-en" data-provider="deepgram">Arcas (Male)</option>
                                <option value="aura-2-orion-en" data-provider="deepgram">Orion (Male)</option>
                                <option value="aura-2-orpheus-en" data-provider="deepgram">Orpheus (Male)</option>
                            </optgroup>
                            <optgroup label="Deepgram - Italiano" data-provider="deepgram">
                                <option value="aura-2-livia-it" data-provider="deepgram">Livia (Femmina)</option>
                                <option value="aura-2-melia-it" data-provider="deepgram">Melia (Femmina)</option>
                                <option value="aura-2-maia-it" data-provider="deepgram">Maia (Femmina)</option>
                                <option value="aura-2-cinzia-it" data-provider="deepgram">Cinzia (Femmina)</option>
                                <option value="aura-2-dionisio-it" data-provider="deepgram">Dionisio (Maschio)</option>
                                <option value="aura-2-elio-it" data-provider="deepgram">Elio (Maschio)</option>
                                <option value="aura-2-flavio-it" data-provider="deepgram">Flavio (Maschio)</option>
                                <option value="aura-2-cesare-it" data-provider="deepgram">Cesare (Maschio)</option>
                            </optgroup>
                            <optgroup label="Google Cloud - Français" data-provider="google">
                                <option value="fr-FR-Chirp-HD-D" data-provider="google">Chirp HD D (Homme)</option>
                                <option value="fr-FR-Chirp-HD-F" data-provider="google">Chirp HD F (Femme)</option>
                                <option value="fr-FR-Chirp-HD-O" data-provider="google">Chirp HD O (Femme)</option>
                                <option value="fr-FR-Chirp3-HD-Achernar" data-provider="google">Chirp3 HD Achernar (Femme)</option>
                                <option value="fr-FR-Chirp3-HD-Achird" data-provider="google">Chirp3 HD Achird (Homme)</option>
                            </optgroup>
                            <optgroup label="Google Cloud - English" data-provider="google">
                                <option value="Achernar" data-provider="google">Achernar (Female)</option>
                                <option value="Achird" data-provider="google">Achird (Male)</option>
                                <option value="Algenib" data-provider="google">Algenib (Male)</option>
                                <option value="Algieba" data-provider="google">Algieba (Male)</option>
                                <option value="Alnilam" data-provider="google">Alnilam (Male)</option>
                            </optgroup>
                        </select>
                        <p class="tts-hint" data-lang="voiceHint">Choisissez la voix pour la lecture du résumé</p>
                    </div>
                    
                    <div class="tts-card">
                        <label for="ttsSpeakingRate">
                            <span class="material-symbols-outlined">speed</span>
                            <span data-lang="speakingRate">Vitesse de lecture</span>
                            <span class="tts-value" id="speakingRateValue">1.0x</span>
                        </label>
                        <input type="range" id="ttsSpeakingRate" min="0.5" max="2.0" step="0.1" value="1.0" oninput="updateTTSValue('speakingRate', this.value)" />
                        <div class="range-labels">
                            <span>0.5x</span>
                            <span>1.0x</span>
                            <span>2.0x</span>
                        </div>
                        <p class="tts-hint" data-lang="speakingRateHint">Contrôle la rapidité de la voix</p>
                    </div>
                    
                    <div class="tts-card">
                        <label for="ttsPitch">
                            <span class="material-symbols-outlined">graphic_eq</span>
                            <span data-lang="pitch">Tonalité (Pitch)</span>
                            <span class="tts-value" id="pitchValue">0</span>
                        </label>
                        <input type="range" id="ttsPitch" min="-20" max="20" step="1" value="0" oninput="updateTTSValue('pitch', this.value)" />
                        <div class="range-labels">
                            <span>-20</span>
                            <span>0</span>
                            <span>+20</span>
                        </div>
                        <p class="tts-hint" data-lang="pitchHint">Ajuste la hauteur de la voix</p>
                    </div>
                    
                    <div class="tts-card">
                        <label for="ttsVolume">
                            <span class="material-symbols-outlined">volume_up</span>
                            <span data-lang="volumeGain">Volume</span>
                            <span class="tts-value" id="volumeValue">0 dB</span>
                        </label>
                        <input type="range" id="ttsVolume" min="-16" max="16" step="1" value="0" oninput="updateTTSValue('volume', this.value)" />
                        <div class="range-labels">
                            <span>-16 dB</span>
                            <span>0 dB</span>
                            <span>+16 dB</span>
                        </div>
                        <p class="tts-hint" data-lang="volumeHint">Ajuste le niveau sonore</p>
                    </div>

                    <div class="tts-card">
                        <label>
                            <span class="material-symbols-outlined">settings</span>
                            <span data-lang="autoPlaySummary">Options</span>
                        </label>
                        <label class="tts-checkbox-label">
                            <input type="checkbox" id="autoPlayTTS" checked />
                            <span data-lang="autoPlayLabel">Lire automatiquement le résumé IA</span>
                        </label>
                        <p class="tts-hint" data-lang="autoPlayHint">Active la lecture automatique quand le résumé est généré</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Search History Section -->
        <section class="history-section">
            <h2>
                <span class="material-symbols-outlined">history</span>
                <span data-lang="searchHistory">Historique des recherches</span>
                <button class="section-toggle" onclick="toggleSection('historyContent')" id="historyToggleBtn">
                    <span data-lang="show">Afficher</span>
                </button>
            </h2>
            
            <div id="historyContent" class="section-content" style="display: none;">
                <div class="history-controls">
                    <button class="btn-clear-history" onclick="clearAllHistory()">
                        <span class="material-symbols-outlined">delete_sweep</span>
                        <span data-lang="clearAllHistory">Effacer tout l'historique</span>
                    </button>
                    <span class="history-count" id="historyCount" data-lang="historyCount">0 recherches</span>
                </div>
                
                <div id="historyList" class="history-list">
                    <div class="history-empty">
                        <span class="material-symbols-outlined">search_off</span>
                        <p data-lang="noHistory">Aucune recherche dans l'historique</p>
                    </div>
                </div>
            </div>
        </section>

        
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>Arnaud Cassone © Artcraft Visuals 2025</p>
        <a href="https://www.artcraft-zone.com" target="_blank" rel="noopener noreferrer">www.artcraft-zone.com</a>
    </footer>

    <script src="script.js"></script>
</body>
</html>
